name: Sync Master back with Develop Branch
on:
  push:
    branches:
    - master

jobs:
  pull-request:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout Production Branch
      uses: actions/checkout@v2
    - name: Check Diff Between Branches
      id: check_diff
      run: |
        echo ""::set-output name=diff::$(git diff --name-only ${{ github.ref }}..develop | wc -l)
    - name: Create The Pull Request
      if: ${{ steps.check_diff.outputs.diff > 0 }}
      uses: repo-sync/pull-request@v2
      with:
        destination_branch: "develop"
        github_token: ${{ secrets.GITHUB_TOKEN }}
        pr_body: "This Pull Request is automatically generated. Please check if there are any accidental code reverts before merging."
        pr_title: "Syncing ${{ github.ref }} back to other environments"
